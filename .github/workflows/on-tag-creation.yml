name: "On tag creation, trigger publish"

on:
    push:
        tags:
            - "v*"

jobs:
    publish:
        runs-on: ubuntu-latest
        steps:
            - uses: actions/checkout@v2
            - uses: olegtarasov/get-tag@v2.1
              id: tagName
              with:
                  tagRegex: "v(.*)"
                  tagRegexGroup: 1
            - uses: ./.github/actions/publish
              with:
                version: "${{ steps.tagName.outputs.tag }}"
                commit: "${{ github.sha }}"
                build_number: "${{ github.run_number }}"
                nuget_api_key: "${{ inputs.nuget_api_key }}"
